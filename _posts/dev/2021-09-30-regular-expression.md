---
layout: post
title: 정규표현식 이해하기
categories: [dev]
tags:

  - javascript
  - regular expression
    author: 문재범
    email: jaebeommun@gmail.com
    date: 2021-09-30
---



## 정규표현식 이해하기

자바스크립트는 많은 언어의 특성이 믹스된 언어인데, 구문은 C언어, 프로토타입같은 상속 개념은 스킴, 그리고 정규식은 펄을 기반으로 한다.

자바스크립트에는 정규식을 활용하는 많은 함수들이 존재한다. 정규식(정규 표현식)이란 특정한 규칙을 가진 문자열의 집합을 표현하는 데 사용하는 형식 언어이다. 정규식을 이용해서 특정한 패턴의 문자열을 추출해 활용 할 수 있기 때문에 아주 유용하다.

그러나 정규식은 특수한 의미를 갖고 있는 '메타문자'와 일반적인 문자열을 의미하는 '리터럴'의 복잡한 조합으로 구성되어 있기 때문에 이해하기 어렵다는 단점이 있다.

그러나 개념을 이해하고 정규식 잘 활용한다면 프로그래밍 할 때 많은 도움이 된다. 또한 자바스크립트 언어 개발자이자, JSON 포맷의 창시자인 더글라스 크록포드의 자바스크립트 핵심 가이드에 따르면 성능상의 이점도 있다고 한다.

자바스크립트에서 정규 표현식을 사용하는 방법은 //(슬래쉬)에 정규표현식을 작성하거나, RegExp 생성자를 활용하는 방법이 있다. 전자의 경우는 단순하게 슬래쉬안에 정규표현식을 기술하면 자바스크립트는 이를 정규식으로 인식한다. 후자의 방법은 RegExp 생성자를 이용하는 방법으로 //를 제외한 표현식 자체를 생성자의 인자로 넣어주면 된다.

RegExp.exec 함수와 정규표현식을 이용해 간단한 url을 쪼개면서 정규표현식을 이해해보자. 여기서 exec 함수는 특정 문자열을 입력받아서 그룹 단위로 문자열을 캡처해서 배열로 반환하는 함수이다.



다음은 정규표현식을 이용해서 쪼개볼 url이다. 임의로 만든것 이다.

```
https://www.mysite.com:8080/ko/docs/js?a=bj&b=c
```

첫 번째 토큰은 http, https, ftp, sftp 같은 프로토콜이 되겠다. 두 번째는 /(슬래쉬)이다. 예제는 //이 요소로 추출될 것이다.세 번째는 포트번호다. 예제는 8080이 요소로 추출될 것이다. 네 번째는 경로이다. /ko/docs/js이다. 다섯 번째는 파라미터이다. js?a=bj&b=c이다.

정규표현식으로 표현하면 다음과 같다. 

```javascript
/^(?:([a-zA-z]+):)?(\/{1,3})?([a-zA-Z0-9.]+)(?::([0-9]+))?([/a-zA-Z0-9]+)?(\?(?:[a-zA-Z0-9]+=[a-zA-Z0-9]+&?)+)?$/
```



먼저 **첫 번째 토큰**인 프로토콜이다.

```javascript
^(?:([a-zA-z]+):)?
```

여기에서 ^는 입력의 시작에 해당한다. 해당하지 않는다면 빠르게 첫 번째 토큰을 넘어 갈 수 있도록 해준다. (?:) 는 토큰에 대응시키지만, 대응한 것을 출력하지는 않는다고 생각하면 된다.

가령 프로토콜의 구분자인 : 는 필요가 없다. 반대되는 개념으로 ()는 대응한 것을 출력한다고 생각하면 이해하기 쉽다. []는 문자셋이다. a-z는 알파벳 소문자, A-Z는 대문자이다. 위의 예제 [a-zA-z] 는 대소문자를 모두 포함한 알파벳이다. 

```javascript
[^a-zA-z]
//※ 앞에서 사용한 ^를 문자셋과 결합하면 입력의 시작이 아니라 완전히 다른 의미가 된다.
```

문자셋 뒤에 +는 1회 이상 연속되는 부분과 대응된다. +가 없다면 알파벳은 1개와만 대응된다. 마지막 :(콜론)은 단일문자라고 생각하면 된다. 해석하면 첫 번째에 오는 모든 영문자에 :가 있다면 대응된다.

마지막 ?에 의미는 0또는 1회, 즉 옵셔널이다.



```
(\/{1,3})?
```

다음으로 **두 번째 토큰**인 /이다. 슬래쉬는 메타문자이다. 앞서 설명했듯이 정규식의 시작을 의미한다. 그렇기 때문에 흔히들 이스케이프문자인 \를 붙혀야 한다. /뿐만 아니라 모든 메타문자 포함이니까 주의해야한다.

뒤에 중괄호의 의미는 /가 최소 1개에서 최대 3개일 때 대응한다는 의미이다. 만약 {2} 로 준다면 2는 최소값을 의미하게 되고, 최대값은 무한대가 된다. 그렇기 때문에 /, //, /// 를 대응한다.



```
([a-zA-Z.]+)
```

**세 번째 토큰**인 주소이다. 문자셋을 보면 1회 이상의 알파벳 대소문자, .와 대응된다.



```javascript
(?::([0-9]+))?
```

**네 번째 토큰**은 포트이다. (?:) 은 출력하지 않는 대응이다 뒤에 :은 출력을 하지 않기 때문이다.  문자셋 [0-9]는 모든 숫자를 대응한다는 의미이고 +가 있기에 숫자의 크기는 상관없다.



```
([/a-zA-Z0-9_]+)?
```

**다섯 번째 토큰**은 경로이다. 앞의 토큰들을 이해했다면 쉽게 이해가 될 것이다.



```
(\?(?:[a-zA-Z0-9]+=[a-zA-Z0-9]+&?)+)?$
```

**여섯 번째 토큰**은 파라미터이다. 

조금 복잡해보이지만 어려울것이 전혀 없다. 먼저 파라미터의 시작인 문자 ?에 대응되며 메타문자이기에 이스케이프처리를 한 것이다. 또한 다음은 a=b형식에 대한 대응이다. 

뒤에 +&? 는 &{0,1}이랑 동일하다. 가장 마지막 파리미터는 &가 없을 수도 있기 때문이다. 이러한 형식의 대응이 1회 이상 반복되어도 대응되어야 하기 때문에 +가 있는 것이다. 마지막 $는^과 반대로 입력의 끝부분과 대응된다. 마지막은 어떠한 문자도 없다는 것을 의미한다. 



```javascript
/** @format */

const url = "https://www.mysite.com:8080/ko/docs/js?a=bj&b=c";

const regx =
  /^(?:([a-zA-z]+):)?(\/{1,3})?([a-zA-Z0-9.]+)(?::([0-9]+))?([/a-zA-Z0-9]+)?(\?(?:[a-zA-Z0-9]+=[a-zA-Z0-9]+&?)+)?$/;
const groups = regx.exec(url);

console.log(`${groups}`);
/** 출력결과
 https://www.mysite.com:8080/ko/docs/js?a=bj&b=c,https,//,www.mysite.com,8080,/ko/docs/js,?a=bj&b=c
 */
```

exec 함수는 0번 째 인덱스에서 input을 반환하고, 1번 째부터 ()에 대응된 토큰을 순서대로 출력한다. (?:)에 해당하는 대응그룹은 모두 제외된 것을 확인 할 수 있다. 

이 외에도 많은 메타문자를 갖고 있다. 그렇지만 본인은 이정도만 숙지해도 다른 정규식을 이해하는데 크게 어려움은 없었다. 참고로 정규식이 길어지는 것은 좋지 않다고 한다. 길이가 짧고 간단하게 가장 좋은 정규식이라고 한다. (더글라스 크록포드曰) 



